---
title: "Nuxt.js + JavaScriptã§ã‚¨ã‚¯ã‚¹ãƒãƒãƒ³ã‚·ãƒ£ãƒ«ãƒãƒƒã‚¯ã‚ªãƒ•ã‚’å®Ÿè£…ã™ã‚‹"
emoji: "ğŸ”–"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: ["JavaScript","AWS","ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ","nuxt.js","ã‚¨ã‚¯ã‚¹ãƒãƒãƒ³ã‚·ãƒ£ãƒ«ãƒãƒƒã‚¯ã‚ªãƒ•"]
published: true
---
## ã‚¨ã‚¯ã‚¹ãƒãƒãƒ³ã‚·ãƒ£ãƒ«ãƒãƒƒã‚¯ã‚ªãƒ•ã¨ã¯ï¼Ÿ

ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã®ä¸€ã¤ã§ã™ã€‚  
ç›´è¨³ã™ã‚‹ã¨ã€ŒæŒ‡æ•°é–¢æ•°çš„å¾Œé€€ã€ã§ã€ã„ã‚ã‚†ã‚‹ãƒªãƒˆãƒ©ã‚¤å‡¦ç†ã®é–“éš”ã‚’æŒ‡æ•°é–¢æ•°çš„ã«å¢—åŠ ã•ã›ã‚‹æ–¹å¼ã®ã“ã¨ã§ã™ã€‚

ãƒªãƒˆãƒ©ã‚¤é–“éš”ä¾‹ï¼š1ç§’ã€2ç§’ã€4ç§’ã€8ç§’ãƒ»ãƒ»ãƒ»



[AWS ã§ã®ã‚¨ãƒ©ãƒ¼å†è©¦è¡Œã¨ã‚¨ã‚¯ã‚¹ãƒãƒãƒ³ã‚·ãƒ£ãƒ«ãƒãƒƒã‚¯ã‚ªãƒ•](https://docs.aws.amazon.com/ja_jp/general/latest/gr/api-retries.html)



## ãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹

ä¸»ã«ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚¨ãƒ©ãƒ¼ã«å¯¾ã—ã¦ã®å†è©¦è¡Œã®æ–¹å¼ã¨ã—ã¦ä½¿ç”¨ã—ã¾ã™ã€‚  
ä¸€æ™‚çš„ãªè² è·ã®ã‚¨ãƒ©ãƒ¼ã«é–¢ã—ã¦ã¯ãƒªãƒˆãƒ©ã‚¤ã§æˆåŠŸã™ã‚‹å¯èƒ½æ€§ãŒé«˜ã„ã§ã™ãŒã€ä¸€èˆ¬çš„ãªã€Œï½ç§’å¾Œã«ãƒªãƒˆãƒ©ã‚¤ã€ã‚’å®Ÿæ–½ã™ã‚‹æ–¹å¼ã ã¨ï½ç§’ã”ã¨ã«åŒã˜é‡ã®è² è·ãŒã‹ã‹ã‚Šç¶šã‘ã‚‹ã“ã¨ãŒæ‡¸å¿µã•ã‚Œã¾ã™ã€‚  
ã‚¨ã‚¯ã‚¹ãƒãƒãƒ³ã‚·ãƒ£ãƒ«ãƒãƒƒã‚¯ã‚ªãƒ•æ–¹å¼ã‚’ä½¿ç”¨ã—ã¦æŒ‡æ•°é–¢æ•°çš„ã«ãƒªãƒˆãƒ©ã‚¤é–“éš”ã‚’å¢—åŠ ã•ã›ã‚‹ã“ã¨ã§ã€åŠ¹ç‡çš„ã«è² è·åˆ†æ•£ã‚’è¡Œãˆã¾ã™ã€‚

## ã‚„ã‚‹ã“ã¨

- ãƒªãƒˆãƒ©ã‚¤ãƒœã‚¿ãƒ³ã‚’æŠ¼ã™ãŸã³ã«æŒ‡æ•°é–¢æ•°çš„ã«ãƒªãƒˆãƒ©ã‚¤å‡¦ç†ã¾ã§ã®é–“éš”ã‚’å¢—åŠ ã•ã›ã‚‹

## æœ¬é¡Œ

Nuxt.js + Vuetifyã‚’ä½¿ç”¨ã—ã¦ä½œã£ã¦ã„ãã¾ã™ã€‚

### ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆä½œæˆ

yarn create nuxt-appã§ã‚µã‚¯ãƒƒã¨ä½œæˆã—ã¾ã™ã€‚

[Nuxt.js ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«](https://ja.nuxtjs.org/guide/installation/)

```sh
yarn create nuxt-app exponential-backoff-sample
yarn create v1.22.4
[1/4] Resolving packages...
warning create-nuxt-app > sao > micromatch > snapdragon > source-map-resolve > resolve-url@0.2.1: https://github.com/lydell/resolve-url#deprecated
warning create-nuxt-app > sao > micromatch > snapdragon > source-map-resolve > urix@0.1.0: Please see https://github.com/lydell/urix#deprecated
[2/4] Fetching packages...
[3/4] Linking dependencies...
[4/4] Building fresh packages...
success Installed "create-nuxt-app@2.15.0" with binaries:
      - create-nuxt-app

create-nuxt-app v2.15.0
âœ¨  Generating Nuxt.js project in exponential-backoff-sample
? Project name exponential-backoff-sample
? Project description My praiseworthy Nuxt.js project
? Author name author
? Choose programming language JavaScript     
? Choose the package manager Yarn     
? Choose UI framework Vuetify.js
? Choose custom server framework None (Recommended)
? Choose Nuxt.js modules (Press <space> to select, <a> to toggle all, <i> to invert selection)
? Choose linting tools (Press <space> to select, <a> to toggle all, <i> to invert selection)
? Choose test framework None
? Choose rendering mode Universal (SSR)
? Choose development tools (Press <space> to select, <a> to toggle all, <i> to invert selection)

ï¿½  Successfully created project exponential-backoff-sample

  To get started:

        cd exponential-backoff-sample
        yarn dev

  To build & start for production:

        cd exponential-backoff-sample
        yarn build
        yarn start
```

### å®Ÿè£…

pages/index.vue

```vue

<template>
  <v-layout column justify-center align-center>
    <v-flex xs12 sm8 md6>
      <div class="text-center">
        <logo />
        <vuetify-logo />
      </div>
      <v-card>
        <v-card-title class="headline">
          exponential-backoff-sample
        </v-card-title>
        <v-card-text>
          æ­£ï¼š{{ judgeBaseNum }}<br />
          ãƒ©ãƒ³ãƒ€ãƒ æ•°å­—{{ judgeNum }}<br /><br />
          æœ€å¤§ãƒªãƒˆãƒ©ã‚¤å›æ•°ï¼š{{ maxRetryNum }}<br />
          ãƒªãƒˆãƒ©ã‚¤å›æ•°ï¼š{{ retryNum }}<br />
          ãƒªãƒˆãƒ©ã‚¤é–“éš”ï¼š{{ retryInterval }}
        </v-card-text>
        <v-card-actions>
          <v-spacer />
          <v-btn color="primary" @click="retry">
            Retry
          </v-btn>
        </v-card-actions>
      </v-card>
    </v-flex>
  </v-layout>
</template>
<script>
import Logo from "~/components/Logo.vue";
import VuetifyLogo from "~/components/VuetifyLogo.vue";

export default {
  data() {
    return {
      retryNum: 0,
      retryInterval: 100,
      judgeBaseNum: 1,
      judgeNum: 0,
      maxRetryNum: 5
    };
  },
  components: {
    Logo,
    VuetifyLogo
  },
  methods: {
    // ãƒ¡ã‚¤ãƒ³å‡¦ç†
    async retry() {
      // é€²æ—ãƒªã‚»ãƒƒãƒˆ
      this.retryNum = 0;
      this.retryInterval = 100;
      while (this.retryNum < this.maxRetryNum) {
        this.retryNum++;
        this.judge();
        if (this.judgeNum === this.judgeBaseNum) {
          break;
        }
        // ã‚¹ãƒªãƒ¼ãƒ—å‡¦ç†
        this.retryInterval = this.retryNum * 100 + this.retryInterval;
        await this.sleep(this.retryInterval);
      }
    },
    // ãƒ©ãƒ³ãƒ€ãƒ æ•°å­—ç”Ÿæˆ
    judge() {
      const random = Math.ceil(Math.random() * 6);
      this.judgeNum = random;
    },
    // ã‚¹ãƒªãƒ¼ãƒ—
    sleep(milliseconds) {
      return new Promise(resolve => setTimeout(resolve, milliseconds));
    }
  }
};
</script>
```

### ãƒªãƒˆãƒ©ã‚¤å‡¦ç†

é‡è¦ãªã®ã¯ã“ã®éƒ¨åˆ†ã§ã™ã€‚

```javascript
// ã‚¹ãƒªãƒ¼ãƒ—å‡¦ç†
this.retryInterval = this.retryNum * 100 + this.retryInterval;
await this.sleep(this.retryInterval);
```

ãƒªãƒˆãƒ©ã‚¤é–“éš”ã‚’ãƒªãƒˆãƒ©ã‚¤å›æ•°  * ãƒªãƒˆãƒ©ã‚¤é–“éš”åŸºæº–å€¤ã‚’ç¾æ™‚ç‚¹ã®ãƒªãƒˆãƒ©ã‚¤é–“éš”ã«è¶³ã—ã¦ã„ã¾ã™ã€‚  
ã“ã®éƒ¨åˆ†ãŒã‚¨ã‚¯ã‚¹ãƒãƒãƒ³ã‚·ãƒ£ãƒ«ãƒãƒƒã‚¯ã‚ªãƒ•ã¨å‘¼ã°ã‚Œã¦ã„ã‚‹æ–¹å¼ã§ã™ã€‚

è£œè¶³ã§ã™ãŒã€ã‚¹ãƒªãƒ¼ãƒ—å‡¦ç†ã¯ä»¥ä¸‹ã‚’å‚è€ƒã«ã—ã¾ã—ãŸã€‚

[JavaScriptã§ãƒ«ãƒ¼ãƒ—ä¸­ã«ã‚¹ãƒªãƒ¼ãƒ—ã—ãŸã„ã€‚ãã‚Œã‚‚èª­ã¿ã‚„ã™ã„ã‚³ãƒ¼ãƒ‰ã§ - Qiita](https://qiita.com/akyao/items/a718cc78436df68d7e15#comment-9a57c092514237fbf558)

## å‹•ä½œç¢ºèª

å‹•ä½œç¢ºèªã—ã¦ã¿ã¾ã—ã‚‡ã†ã€‚

```sh
yarn dev
yarn run v1.22.4
$ nuxt

   â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
   â”‚                                             â”‚
   â”‚   Nuxt.js v2.12.2                           â”‚
   â”‚   Running in development mode (universal)   â”‚
   â”‚                                             â”‚
   â”‚   Listening on: http://localhost:3000/      â”‚
   â”‚                                             â”‚
   â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

i Preparing project for development
i Initial build may take a while
âˆš Builder initialized
âˆš Nuxt files generated

âˆš Client
  Compiled successfully in 10.40s

âˆš Server
  Compiled successfully in 9.19s

i Waiting for file changes
i Memory usage: 348 MB (RSS: 443 MB)
i Listening on: http://localhost:3000/
```

[http://localhost:3000/](http://localhost:3000/)ã«ã‚¢ã‚¯ã‚»ã‚¹ã—ã¾ã™ã€‚

![Untitle2d.png](https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/246580/ce086d6b-fb75-572b-da63-d30a52b0379b.png)

RETRYãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¦ã¿ã¾ã™ã€‚  
ãƒ©ãƒ³ãƒ€ãƒ æ•°å­—ã®è¡¨ç¤ºãŒåˆ‡ã‚Šæ›¿ã‚ã‚Šã€ãƒ©ãƒ³ãƒ€ãƒ æ•°å­—ãŒï¼‘ã«ãªã‚‹ã‹ãƒªãƒˆãƒ©ã‚¤å›æ•°ãŒï¼•å›ã«ãªã‚‹ã¾ã§ãƒªãƒˆãƒ©ã‚¤å‡¦ç†ãŒç¶šãã¾ã™ã€‚  
ãã®ã¨ãã€ãƒªãƒˆãƒ©ã‚¤é–“éš”ã®è¡¨ç¤ºãŒå¢—åŠ ã™ã‚‹ã“ã¨ã¨ã€å®Ÿéš›ã«ãƒªãƒˆãƒ©ã‚¤ã•ã‚Œã‚‹ã¾ã§ã®é–“éš”ãŒå¢—åŠ ã™ã‚‹ã“ã¨ãŒç¢ºèªã§ãã¾ã™ã€‚

## ãŠã‚ã‚Šã«

JavaScriptã§ã‚¨ã‚¯ã‚¹ãƒãƒãƒ³ã‚·ãƒ£ãƒ«ãƒãƒƒã‚¯ã‚ªãƒ•æ–¹å¼ã‚’å®Ÿè£…ã—ã¦ã¿ã¾ã—ãŸã€‚  
AWSã¯ã‚‚ã¡ã‚ã‚“ã€æ§˜ã€…ãªAPIã‚³ãƒ¼ãƒ«ãªã©ã§æ±ç”¨çš„ã«å¿…è¦ãªæ¦‚å¿µã¨ãªã‚Šã¾ã™ã€‚  
ã„ã‚ã„ã‚ãªå®Ÿç¾æ–¹å¼ã‚’è‡ªåˆ†ã®ä¸­ã§ç¢ºç«‹ã—ã¦ãŠããŸã„ã§ã™ã­ã€‚
